<html>
  <head>
    <script>
      function checkDistance(event) {
        event.preventDefault();

        var from = event.currentTarget[0].value
        var max = event.currentTarget[1].value
        var to = event.currentTarget[2].value
        var url = encodeURI(`https://isitfar.vercel.app/api/v1/handler?from=${from}&to=${to}`)

        var request = new XMLHttpRequest();
        request.open('GET', url, true);
        request.onload = function() {
          var distance = parseInt(request.responseText);

          if (distance <= max) {
            document.getElementById('ok').style.display = 'block';
            document.getElementById('denied').style.display = 'none';
          } else {
            document.getElementById('ok').style.display = 'none';
            document.getElementById('denied').style.display = 'block';
          }
        };
        request.send();
      }
    </script>

  </head>
  <body>

    <form onsubmit='checkDistance(event)'>
      <label for='from'>Where are you?</label><br>
      <input type='text' id='from' name='from' placeholder='postcode'><br>
      <label for='max'>How far will you go?</label><br>
      <input type='text' id='max' name='max' placeholder='metres'><br>
      <label for='to'>Where is the dropoff?</label><br>
      <input type='text' id='to' name='to' placeholder='postcode'><br><br>
      <input type='submit' value='Submit'>
    </form>

    <div id='denied' style='display: none'>You don't deliver this far!</div>
    <div id='ok' style='display: none'>Nice, you deliver to this location!</div>

  </body>
</html>
