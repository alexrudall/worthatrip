<html>
  <head>
    <script>
      function checkDistance(event) {
        event.preventDefault();

        document.getElementById('output').innerHTML = 'Searching...';

        var from = event.currentTarget[0].value
        var max = event.currentTarget[1].value
        var to = event.currentTarget[2].value
        var url = encodeURI(`api/v1/handler?from=${from}&to=${to}`)

        var request = new XMLHttpRequest();
        request.open('GET', url, true);
        request.onload = function() {
          if (this.status == 200) {
            var distance = parseInt(request.responseText);

            if (distance <= max) {
              document.getElementById('output').innerHTML = 'Nice, you deliver to this location!';
            } else {
              document.getElementById('output').innerHTML = "You don't deliver this far!";
            }
          } else {
            document.getElementById('output').innerHTML = 'Error: ' + request.responseText;
          }
        };
        request.send();
      }
    </script>

  </head>
  <body>

    <form onsubmit='checkDistance(event)'>
      <label for='from'>Where are you?</label><br>
      <input type='text' id='from' name='from' placeholder='postcode' required><br>
      <label for='max'>How far will you go?</label><br>
      <input type='number' id='max' name='max' placeholder='metres' required><br>
      <label for='to'>Where is the dropoff?</label><br>
      <input type='text' id='to' name='to' placeholder='postcode' required><br><br>
      <input type='submit' value='Submit'>
    </form>

    <div id='output'></div>
  </body>
</html>
